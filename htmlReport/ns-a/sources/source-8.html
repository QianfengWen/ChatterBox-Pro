


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=GBK"> 
  <title>Coverage Report > LoginView</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">chattingSystem.frameworks_drivers.ui.views</a>
</div>

<h1>Coverage Summary for Class: LoginView (chattingSystem.frameworks_drivers.ui.views)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">LoginView</td>
<td class="coverageStat">
  <span class="percent">
    80%
  </span>
  <span class="absValue">
    (4/5)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    91.5%
  </span>
  <span class="absValue">
    (86/94)
  </span>
</td>
</tr>
  <tr>
    <td class="name">LoginView$1</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (6/6)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">LoginView$2</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    8.3%
  </span>
  <span class="absValue">
    (1/12)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">LoginView$3</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (4/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">LoginView$4</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (2/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    66.7%
  </span>
  <span class="absValue">
    (4/6)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">LoginView$5</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (2/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    66.7%
  </span>
  <span class="absValue">
    (4/6)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    68.4%
  </span>
  <span class="absValue">
    (13/19)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    82%
  </span>
  <span class="absValue">
    (105/128)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package chattingSystem.frameworks_drivers.ui.views;
&nbsp;
&nbsp;import chattingSystem.interface_adapter.controllers.JoinChatRoomController;
&nbsp;import chattingSystem.interface_adapter.controllers.LoginController;
&nbsp;import chattingSystem.interface_adapter.state.LoginState;
&nbsp;import chattingSystem.interface_adapter.view_models.LoginViewModel;
&nbsp;import chattingSystem.interface_adapter.view_models.ViewManagerModel;
&nbsp;
&nbsp;import javax.swing.*;
&nbsp;import java.awt.*;
&nbsp;import java.awt.event.ActionEvent;
&nbsp;import java.awt.event.ActionListener;
&nbsp;import java.awt.event.KeyEvent;
&nbsp;import java.awt.event.KeyListener;
&nbsp;import java.beans.PropertyChangeEvent;
&nbsp;import java.beans.PropertyChangeListener;
&nbsp;import java.io.IOException;
&nbsp;
&nbsp;public class LoginView extends JPanel implements ActionListener, PropertyChangeListener {
<b class="fc">&nbsp;    public final String viewName = &quot;log in&quot;;</b>
&nbsp;    private final LoginViewModel loginViewModel;
&nbsp;    private final ViewManagerModel viewManagerModel;
<b class="fc">&nbsp;    private final JTextField usernameInputField = new JTextField(15);</b>
<b class="fc">&nbsp;    private final JPasswordField passwordInputField = new JPasswordField(15);</b>
&nbsp;    private final LoginController loginController;
&nbsp;    private final JoinChatRoomController joinChatRoomController;
&nbsp;
&nbsp;    private final JButton logIn;
&nbsp;    private final JButton signUp;
&nbsp;    private final JButton cancel;
&nbsp;
<b class="fc">&nbsp;    public LoginView(LoginController controller, JoinChatRoomController joinChatRoomController,LoginViewModel loginViewModel, ViewManagerModel viewManagerModel) {</b>
<b class="fc">&nbsp;        this.loginController = controller;</b>
<b class="fc">&nbsp;        this.joinChatRoomController= joinChatRoomController;</b>
<b class="fc">&nbsp;        this.loginViewModel = loginViewModel;</b>
<b class="fc">&nbsp;        this.viewManagerModel = viewManagerModel;</b>
<b class="fc">&nbsp;        loginViewModel.addPropertyChangeListener(this);</b>
&nbsp;
<b class="fc">&nbsp;        setLayout(new GridBagLayout());</b>
<b class="fc">&nbsp;        GridBagConstraints gbc = new GridBagConstraints();</b>
<b class="fc">&nbsp;        gbc.fill = GridBagConstraints.HORIZONTAL;</b>
&nbsp;
&nbsp;        // Title
<b class="fc">&nbsp;        JLabel title = new JLabel(loginViewModel.TITLE_LABEL, SwingConstants.CENTER);</b>
<b class="fc">&nbsp;        title.setFont(new Font(&quot;Times&quot;, Font.BOLD, 24));</b>
&nbsp;        // let title be more beautiful and higher in the window
<b class="fc">&nbsp;        title.setForeground(new Color(30, 144, 255));</b>
<b class="fc">&nbsp;        title.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));</b>
<b class="fc">&nbsp;        gbc.gridwidth = 2;</b>
<b class="fc">&nbsp;        gbc.gridx = 0;</b>
<b class="fc">&nbsp;        gbc.gridy = 0;</b>
<b class="fc">&nbsp;        gbc.insets = new Insets(10, 10, 5, 10);</b>
<b class="fc">&nbsp;        add(title, gbc);</b>
&nbsp;
&nbsp;        // Username label and text field
<b class="fc">&nbsp;        gbc.gridy++;</b>
<b class="fc">&nbsp;        gbc.gridwidth = 1;</b>
<b class="fc">&nbsp;        gbc.insets = new Insets(5, 10, 5, 5);</b>
<b class="fc">&nbsp;        add(new JLabel(loginViewModel.USERNAME_LABEL), gbc);</b>
&nbsp;
<b class="fc">&nbsp;        gbc.gridx++;</b>
<b class="fc">&nbsp;        gbc.insets = new Insets(5, 5, 5, 10);</b>
<b class="fc">&nbsp;        add(usernameInputField, gbc);</b>
&nbsp;
&nbsp;        // Password label and text field
<b class="fc">&nbsp;        gbc.gridy++;</b>
<b class="fc">&nbsp;        gbc.gridx = 0;</b>
<b class="fc">&nbsp;        gbc.insets = new Insets(5, 10, 5, 5);</b>
<b class="fc">&nbsp;        add(new JLabel(loginViewModel.PASSWORD_LABEL), gbc);</b>
&nbsp;
<b class="fc">&nbsp;        gbc.gridx++;</b>
<b class="fc">&nbsp;        gbc.insets = new Insets(5, 5, 5, 10);</b>
<b class="fc">&nbsp;        add(passwordInputField, gbc);</b>
&nbsp;
&nbsp;
&nbsp;        // Buttons
<b class="fc">&nbsp;        gbc.gridy++;</b>
<b class="fc">&nbsp;        gbc.insets = new Insets(10, 10, 10, 10);</b>
<b class="fc">&nbsp;        JPanel buttonsPanel = new JPanel(new FlowLayout(FlowLayout.CENTER, 10, 0));</b>
<b class="fc">&nbsp;        logIn = new JButton(LoginViewModel.LOGIN_BUTTON_LABEL);</b>
<b class="fc">&nbsp;        buttonsPanel.add(logIn);</b>
<b class="fc">&nbsp;        signUp = new JButton(&quot;Sign up&quot;);</b>
<b class="fc">&nbsp;        buttonsPanel.add(signUp);</b>
<b class="fc">&nbsp;        add(buttonsPanel, gbc);</b>
<b class="fc">&nbsp;        cancel = new JButton(LoginViewModel.CANCEL_BUTTON_LABEL);</b>
<b class="fc">&nbsp;        buttonsPanel.add(cancel);</b>
<b class="fc">&nbsp;        add(buttonsPanel, gbc);</b>
&nbsp;
&nbsp;        // Customize components
<b class="fc">&nbsp;        customizeComponents();</b>
&nbsp;
&nbsp;        // Add listeners
<b class="fc">&nbsp;        logIn.addActionListener(                // This creates an anonymous subclass of ActionListener and instantiates it.</b>
<b class="fc">&nbsp;                new ActionListener() {</b>
&nbsp;                    public void actionPerformed(ActionEvent evt) {
<b class="fc">&nbsp;                        if (evt.getSource().equals(logIn)) {</b>
<b class="fc">&nbsp;                            LoginState currentState = loginViewModel.getState();</b>
&nbsp;
<b class="fc">&nbsp;                            loginController.execute(</b>
<b class="fc">&nbsp;                                    currentState.getUsername(),</b>
<b class="fc">&nbsp;                                    currentState.getPassword()</b>
&nbsp;                            );
&nbsp;                        }
&nbsp;                    }
&nbsp;                }
&nbsp;        );
&nbsp;
<b class="fc">&nbsp;        cancel.addActionListener(</b>
<b class="fc">&nbsp;                new ActionListener() {</b>
&nbsp;                    @Override
&nbsp;                    public void actionPerformed(ActionEvent e) {
<b class="nc">&nbsp;                        if (e.getSource().equals(cancel)) {</b>
<b class="nc">&nbsp;                            if (e.getSource().equals(cancel)) {</b>
&nbsp;                                // pump a message to the user whether to confirm the cancelation
<b class="nc">&nbsp;                                int result = JOptionPane.showConfirmDialog(LoginView.this, &quot;Are you sure you want to cancel the login process?&quot;);</b>
<b class="nc">&nbsp;                                if (result != JOptionPane.YES_OPTION) {</b>
&nbsp;                                    return;
&nbsp;                                }
&nbsp;                                // Clear the input fields
<b class="nc">&nbsp;                                usernameInputField.setText(&quot;&quot;);</b>
<b class="nc">&nbsp;                                passwordInputField.setText(&quot;&quot;);</b>
&nbsp;
&nbsp;                                // Reset the state if needed
<b class="nc">&nbsp;                                LoginState currentState = loginViewModel.getState();</b>
<b class="nc">&nbsp;                                currentState.setUsername(&quot;&quot;);</b>
<b class="nc">&nbsp;                                currentState.setPassword(&quot;&quot;);</b>
<b class="nc">&nbsp;                                loginViewModel.setState(currentState);</b>
&nbsp;
&nbsp;                                // Optionally, inform the user that the signup process has been canceled
<b class="nc">&nbsp;                                JOptionPane.showMessageDialog(LoginView.this, &quot;Login process has been canceled.&quot;);</b>
&nbsp;
&nbsp;                                // Handle any other logic that should occur after canceling the login,
&nbsp;                                // such as switching to a different view, if applicable.
&nbsp;                                // ...
&nbsp;                            }
&nbsp;                        }
&nbsp;
&nbsp;                    }
&nbsp;                }
&nbsp;        );
<b class="fc">&nbsp;        signUp.addActionListener(</b>
<b class="fc">&nbsp;                new ActionListener() {</b>
&nbsp;                    public void actionPerformed(ActionEvent e) {
<b class="fc">&nbsp;                        if (e.getSource().equals(signUp)) {</b>
<b class="fc">&nbsp;                            viewManagerModel.setActiveView(&quot;sign up&quot;);</b>
<b class="fc">&nbsp;                            viewManagerModel.firePropertyChanged();</b>
&nbsp;                        }
&nbsp;                    }
&nbsp;                }
&nbsp;        );
&nbsp;
<b class="fc">&nbsp;        usernameInputField.addKeyListener(new KeyListener() {</b>
&nbsp;            @Override
&nbsp;            public void keyTyped(KeyEvent e) {
<b class="fc">&nbsp;                LoginState currentState = loginViewModel.getState();</b>
<b class="fc">&nbsp;                currentState.setUsername(usernameInputField.getText() + e.getKeyChar());</b>
<b class="fc">&nbsp;                loginViewModel.setState(currentState);</b>
&nbsp;            }
&nbsp;
&nbsp;            @Override
&nbsp;            public void keyPressed(KeyEvent e) {
<b class="nc">&nbsp;            }</b>
&nbsp;
&nbsp;            @Override
&nbsp;            public void keyReleased(KeyEvent e) {
<b class="nc">&nbsp;            }</b>
&nbsp;        });
&nbsp;
<b class="fc">&nbsp;        passwordInputField.addKeyListener(</b>
<b class="fc">&nbsp;                new KeyListener() {</b>
&nbsp;                    @Override
&nbsp;                    public void keyTyped(KeyEvent e) {
<b class="fc">&nbsp;                        LoginState currentState = loginViewModel.getState();</b>
<b class="fc">&nbsp;                        currentState.setPassword(passwordInputField.getText() + e.getKeyChar());</b>
<b class="fc">&nbsp;                        loginViewModel.setState(currentState);</b>
&nbsp;                    }
&nbsp;
&nbsp;                    @Override
&nbsp;                    public void keyPressed(KeyEvent e) {
<b class="nc">&nbsp;                    }</b>
&nbsp;
&nbsp;                    @Override
&nbsp;                    public void keyReleased(KeyEvent e) {
<b class="nc">&nbsp;                    }</b>
&nbsp;                });
&nbsp;    }
&nbsp;    private void customizeComponents() {
&nbsp;        // Customize the UI elements here (fonts, borders, colors, etc.)
&nbsp;        // Consider using a UIManager to set a theme or custom styling
&nbsp;
&nbsp;        // making the window bigger only for the login view
&nbsp;
&nbsp;        // making the caption more beautiful
<b class="fc">&nbsp;        usernameInputField.setFont(new Font(&quot;Times&quot;, Font.BOLD, 12));</b>
<b class="fc">&nbsp;        passwordInputField.setFont(new Font(&quot;Times&quot;, Font.BOLD, 12));</b>
&nbsp;
&nbsp;        // setting the background color
<b class="fc">&nbsp;        usernameInputField.setBorder(BorderFactory.createLineBorder(Color.GRAY, 1));</b>
<b class="fc">&nbsp;        passwordInputField.setBorder(BorderFactory.createLineBorder(Color.GRAY, 1));</b>
&nbsp;
<b class="fc">&nbsp;        logIn.setBackground(new Color(7, 129, 23, 205));</b>
<b class="fc">&nbsp;        logIn.setForeground(Color.WHITE);</b>
<b class="fc">&nbsp;        logIn.setFocusPainted(false);</b>
<b class="fc">&nbsp;        logIn.setFont(new Font(&quot;Arial&quot;, Font.BOLD, 12));</b>
&nbsp;
<b class="fc">&nbsp;        signUp.setBackground(new Color(30, 144, 255));</b>
<b class="fc">&nbsp;        signUp.setForeground(Color.WHITE);</b>
<b class="fc">&nbsp;        signUp.setFocusPainted(false);</b>
<b class="fc">&nbsp;        signUp.setFont(new Font(&quot;Arial&quot;, Font.BOLD, 12));</b>
&nbsp;
<b class="fc">&nbsp;        cancel.setBackground(Color.LIGHT_GRAY);</b>
<b class="fc">&nbsp;        cancel.setForeground(Color.WHITE);</b>
<b class="fc">&nbsp;        cancel.setFocusPainted(false);</b>
<b class="fc">&nbsp;        cancel.setFont(new Font(&quot;Arial&quot;, Font.BOLD, 12));</b>
&nbsp;    }
&nbsp;
&nbsp;    public void actionPerformed(ActionEvent evt) {
<b class="nc">&nbsp;        System.out.println(&quot;Click &quot; + evt.getActionCommand());</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void propertyChange(PropertyChangeEvent evt) {
<b class="fc">&nbsp;            LoginState state = (LoginState) evt.getNewValue();</b>
<b class="fc">&nbsp;            setFields(state);</b>
<b class="fc">&nbsp;            if (state.getUsernameError() != null) {</b>
<b class="nc">&nbsp;                JOptionPane.showMessageDialog(this, state.getUsernameError());</b>
<b class="nc">&nbsp;                state.setUsernameError(null);</b>
<b class="fc">&nbsp;            } else if (state.getPasswordError() != null) {</b>
<b class="nc">&nbsp;                JOptionPane.showMessageDialog(this, state.getPasswordError());</b>
<b class="nc">&nbsp;                state.setPasswordError(null);</b>
<b class="fc">&nbsp;            } else if (state.SignupSuccess()){</b>
<b class="nc">&nbsp;                state.setSignupSuccess(false);</b>
&nbsp;            }
<b class="fc">&nbsp;            else if (state.loginSuccess()){</b>
<b class="fc">&nbsp;                    LoginState currentState = loginViewModel.getState();</b>
&nbsp;                        try {
<b class="fc">&nbsp;                            joinChatRoomController.execute(currentState.getUsername());</b>
<b class="nc">&nbsp;                        } catch (IOException e) {</b>
<b class="nc">&nbsp;                            throw new RuntimeException(e);</b>
<b class="fc">&nbsp;                        }</b>
<b class="fc">&nbsp;                        JOptionPane.showMessageDialog(this, &quot;Login successful!&quot;);</b>
&nbsp;                        // Clear the input fields
<b class="fc">&nbsp;                        usernameInputField.setText(&quot;&quot;);</b>
<b class="fc">&nbsp;                        passwordInputField.setText(&quot;&quot;);</b>
&nbsp;                        // Reset the state if needed
<b class="fc">&nbsp;                        currentState.setUsername(&quot;&quot;);</b>
<b class="fc">&nbsp;                        currentState.setPassword(&quot;&quot;);</b>
<b class="fc">&nbsp;                        currentState.setLoginSuccess(false);</b>
<b class="fc">&nbsp;                        loginViewModel.setState(currentState);</b>
<b class="fc">&nbsp;                        viewManagerModel.setActiveView(&quot;log in&quot;);</b>
&nbsp;            }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    private void setFields(LoginState state) {
<b class="fc">&nbsp;        usernameInputField.setText(state.getUsername());</b>
&nbsp;    }
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-12-02 17:40</div>
</div>
</body>
</html>
